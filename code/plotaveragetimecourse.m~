% plotaveragetimecourse

% Load the atlas (change path if necessary)
load('/Users/shreyasaxena/Dropbox/Documents/Labwork/Columbia/Data/Cat/BRAINYAC_data/iGlusnfr/Cohort6_DC2/baseline/warped_atlas.mat');

% Visualize the atlas
figure;
imagesc(atlas)

% Visualize the area that is secondary motor cortex, right hand side 
% (hint: look at 'areanames')
figure;
imagesc(atlas == -21)

% find x and y indices for all pixels in that area
[xindex,yindex] = find(atlas == -21);

atlas(xindex(1),yindex(1))

T = 5000; % how many time points to plot?
fs = 150; % frames per second
x = (1:T)/fs; % time axis in seconds


for j=1:length(xindex)
    y = squeeze(data(xindex(j),yindex(j),1:T)); % motor region
    plot(x,y);hold on;
end

t=1;
y_t=zeros(length(xindex),1);
for j=1:length(xindex)
    y_t(j)=data(xindex(j),yindex(j),t);
end
y_ave=mean(y_t);



y_ave=zeros(T,1);
for t=1:T
    y_t=zeros(length(xindex),1);
    for j=1:length(xindex)
        y_t(j)=data(xindex(j),yindex(j),t);
    end
    y_ave(t)=mean(y_t);
end



